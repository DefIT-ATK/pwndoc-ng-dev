<div v-if="!loading" class="row">
    <div class="col-md-8 col-12 offset-md-2 q-mt-md">

        <q-card class="q-my-md">
          <q-card-section class="q-py-none bg-blue-grey-5 text-white">
              <q-item style="padding:0px;">
                  <q-item-section class="col-md-11">
                      <div class="text-h6">{{$t('generalSettings')}}</div>
                  </q-item-section>
              </q-item>
          </q-card-section>
          <q-card-section>
            <div class="text-bold">{{$t('changeDisplayLanguage')}}</div>
            <br/>
            <div class="text-grey-8">{{$t('changeDisplayLanguageInfo')}}</div>
            <br/>
            <q-item>
              <q-item-section class="col-md-2">
                <language-selector></language-selector>
              </q-item-section>
            </q-item>
          </q-card-section>
          <q-card-section>
            <div class="text-bold">{{$t('extendCvssTemporalEnvironment')}}</div>
            <q-item>
                <q-item-section class="col-md-2">
                    <q-toggle :label="$t('btn.enable')" v-model="settings.report.public.extendCvssTemporalEnvironment" />
                </q-item-section>
            </q-item>
        </q-card-section>
        </q-card>

<!-- Danger Settings START  -->
<q-card v-if="UserService.isAllowed('settings:read')" class="q-my-mg">
    <q-card-section class="q-py-none bg-red text-white">
        <q-item style="padding:0px;">
            <q-item-section class="col-11">
                <div class="text-h6">{{$t('dangerSettings')}}</div>
            </q-item-section>
            <q-item-section class="col-md-1 items-center" >
                <q-toggle
                    color="primary"
                    keep-color
                    :disable="!canEdit"
                    v-model="settings.danger.enabled"
                />
            </q-item-section>
        </q-item>
    </q-card-section>
    <q-card-section>
        <div class="text-bold">{{$t('autoDeleteReport')}}</div>
        <br/>
        <q-item>
            <q-item-section class="col-2">
                <q-input
                v-model.number="settings.danger.public.nbdaydelete"
                type="number"
                filled
                :disable="!canEdit || !settings.danger.enabled"
                :hint="$t('numberDayBeforeDelete')"
                />
            </q-item-section>
        </q-item>
    </q-card-section>
</q-card>
<!-- Danger Settings END  -->

        <q-card v-if="UserService.isAllowed('settings:read')" class="q-my-md">
            <q-card-section class="q-py-none bg-blue-grey-5 text-white">
                <q-item style="padding:0px;">
                    <q-item-section class="col-md-11">
                        <div class="text-h6">{{$t('reports')}}</div>
                    </q-item-section>
                </q-item>
            </q-card-section>
            <div v-if="UserService.isAllowed('settings:update')">
                <q-card-section>
                    <div class="text-bold">{{$t('reportsImagesBorder')}}</div>
                    <br/>
                    <div class="text-grey-8">{{$t('addBorderToImages')}}</div>
                    <br/>
                    <q-item>
                        <q-item-section class="col-md-2">
                            <q-toggle :label="$t('btn.enable')" v-model="settings.report.private.imageBorder" />
                        </q-item-section>
                        <q-item-section class="col-md-1">
                            <input :disabled="!settings.report.private.imageBorder" type="color" id="colorpicker" v-model="settings.report.private.imageBorderColor" />
                        </q-item-section>
                        <q-item-section class="col-md-2">
                            <label :disabled="!settings.report.private.imageBorder" for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.private.imageBorderColor}}</label>
                        </q-item-section>
                    </q-item>
                </q-card-section>
                <q-separator />
                <q-card-section>
                    <div class="text-bold">{{$t('cvssColors')}}</div>
                    <br/>
                    <div class="text-grey-8">{{$t('changeCvssColorsDescription')}}</div>
                    <br/>
                    <q-list>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('critical')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.cvssColors.criticalColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.cvssColors.criticalColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('high')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.cvssColors.highColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.cvssColors.highColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('medium')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.cvssColors.mediumColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.cvssColors.mediumColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('low')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.cvssColors.lowColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.cvssColors.lowColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('informational')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.cvssColors.noneColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.cvssColors.noneColor}}</label>
                            </q-item-section>
                        </q-item>
                    </q-list>
                </q-card-section>
                <q-separator />
<!-- remediation complexity color -->
                <q-card-section>
                    <div class="text-bold">{{$t('remediationColorsComplexity')}}</div>
                    <br/>
                    <div class="text-grey-8">{{$t('changeRemediationColorsDescriptionComplexity')}}</div>
                    <br/>
                    <q-list>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('complex')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.remediationColorsComplexity.highColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.remediationColorsComplexity.highColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('medium')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.remediationColorsComplexity.mediumColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.remediationColorsComplexity.mediumColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('easy')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.remediationColorsComplexity.lowColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.remediationColorsComplexity.lowColor}}</label>
                            </q-item-section>
                        </q-item>
                    </q-list>
                </q-card-section>
                <q-separator />
<!-- Remediation complexity color end -->
<!-- remediation priority color start -->
                <q-card-section>
                    <div class="text-bold">{{$t('remediationColorsPriority')}}</div>
                    <br/>
                    <div class="text-grey-8">{{$t('changeRemediationColorsDescriptionPriority')}}</div>
                    <br/>
                    <q-list>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('urgent')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.remediationColorsPriority.urgentColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.remediationColorsPriority.urgentColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('high')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.remediationColorsPriority.highColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.remediationColorsPriority.highColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('medium')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.remediationColorsPriority.mediumColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.remediationColorsPriority.mediumColor}}</label>
                            </q-item-section>
                        </q-item>
                        <q-item>
                            <q-item-section class="col-md-2">
                                <label class="vertical-center">{{$t('low')}} : </label>
                            </q-item-section>
                            <q-item-section class="col-md-1">
                                <input type="color" id="colorpicker" v-model="settings.report.public.remediationColorsPriority.lowColor"/>
                            </q-item-section>
                            <q-item-section class="col-md-2">
                                <label for="colorpicker" class="vertical-center">{{$t('currentColor')}}: {{settings.report.public.remediationColorsPriority.lowColor}}</label>
                            </q-item-section>
                        </q-item>
                    </q-list>
                </q-card-section>
                <q-separator />
<!-- Remediation priority color end -->
                <q-card-section>
                    <div class="text-bold">{{$t('captions')}}</div>
                    <br/>
                    <div class="text-grey-8">{{$t('captionsDescription')}}</div>
                    <br/>
                    <q-item>
                        <q-item-section class="col-md-6">
                            <q-select
                            label="Caption Labels'"
                            stack-label
                            outlined
                            v-model="settings.report.public.captions"
                            use-input
                            use-chips
                            multiple
                            hide-dropdown-icon
                            options-sanitize
                            input-debounce="0"
                            new-value-mode="add-unique"
                        />
                        </q-item-section>
                    </q-item>
                </q-card-section>
            </div>
        </q-card>

        <q-card v-if="UserService.isAllowed('settings:read')" class="q-my-lg">
            <q-card-section class="q-py-none bg-blue-grey-5 text-white">
                <q-item style="padding:0px;">
                    <q-item-section class="col-11">
                        <div class="text-h6">{{$t('reviews')}}</div>
                    </q-item-section>
                    <q-item-section class="col-md-1 items-center" >
                        <q-toggle
                            color="primary"
                            keep-color
                            :disable="!canEdit"
                            v-model="settings.reviews.enabled"
                        />
                    </q-item-section>
                </q-item>
            </q-card-section>
            <q-separator />
            <q-card-section>
                <div class="text-bold">{{$t('auditUpdateAfterApproval')}}</div>
                <br/>
                <div class="text-grey-8">
                    {{$t('changeApproveBehaviorIfAuditUpdated')}}
                </div>
            </q-card-section>
            <q-card-section>
                <q-btn-toggle
                    :disable="!canEdit || !settings.reviews.enabled"
                    v-model="settings.reviews.private.removeApprovalsUponUpdate"
                    class="toggleButton"
                    spread
                    no-caps
                    rounded
                    unelevated
                    toggle-color="primary"
                    color="white"
                    text-color="primary"
                    :options="[
                    {label: $t('removeAllPriorApprovals'), value: true},
                    {label: $t('keepAllPriorApprovals'), value: false}
                    ]"
                />
            </q-card-section>
            <q-separator />
            <q-card-section>
                <div class="text-bold">{{$t('mandatoryReview')}}</div>
                <br/>
                <div class="text-grey-8" v-html="$t('mandatoryReviewInfo')"></div>
            </q-card-section>
            <q-card-section>
                <q-item>
                    <q-item-section class="col-2">
                        <q-toggle
                            :label="$t('btn.enable')"
                            v-model="settings.reviews.public.mandatoryReview"
                            color="primary"
                            keep-color
                            id="toggle"
                            :disable="!canEdit || !settings.reviews.enabled"
                        />
                    </q-item-section>
                    <q-item-section class="col-2">
                        <q-input
                            v-model.number="settings.reviews.public.minReviewers"
                            type="number"
                            :disable="!canEdit || !settings.reviews.enabled"
                            filled
                            :min="1"
                            :max="99"
                            :hint="$t('minimalNumberOfReviewers')"
                        />
                    </q-item-section>
                </q-item>
            </q-card-section>
        </q-card>

        <q-card class="q-my-md">
            <q-card-section class="q-py-none bg-blue-grey-5 text-white">
              <q-item style="padding:0px;">
                <q-item-section class="col-md-11">
                  <div class="text-h6">Tool Integrations</div>
                </q-item-section>
              </q-item>
            </q-card-section>
            <q-card-section>
              <div class="text-bold">PingCastle Map</div>
              <div class="text-grey-8 q-mb-sm">
                Edit the mapping between PingCastle risk IDs and vulnerability titles.
              </div>
              <q-btn
                color="primary"
                label="Edit PingCastle Map"
                @click="openPingcastleDialog"
                class="q-mb-md"
              />
            </q-card-section>
            
            <q-separator />
            
            <q-card-section>
              <div class="text-bold">PurpleKnight Column Exclusions</div>
              <div class="text-grey-8 q-mb-sm">
                Configure which columns to exclude when parsing PurpleKnight result sheets into HTML tables.
              </div>
              <q-btn
                color="primary"
                label="Edit Column Exclusions"
                @click="openPurpleknightDialog"
                class="q-mb-md"
              />
            </q-card-section>
            
            <q-separator />
            
            <q-card-section>
              <div class="text-bold">Acunetix API Integration</div>
              <div class="text-grey-8 q-mb-md">
                Configure connection settings for direct Acunetix API integration. This allows importing vulnerabilities directly from Acunetix target groups without manual export.
              </div>
              
              <div class="row q-gutter-md">
                <div class="col-12 col-md-5">
                  <q-input
                    v-model="settings.toolIntegrations.acunetix.serverAddress"
                    label="Server Address"
                    placeholder="https://acunetix.example.com"
                    outlined
                    :disable="!canEdit"
                    hint="Full URL to your Acunetix server (including https://)"
                  />
                </div>
                <div class="col-12 col-md-3">
                  <q-input
                    v-model="settings.toolIntegrations.acunetix.email"
                    label="Email"
                    type="email"
                    outlined
                    :disable="!canEdit"
                    hint="Acunetix login email"
                  />
                </div>
                <div class="col-12 col-md-3">
                  <q-input
                    v-model="settings.toolIntegrations.acunetix.password"
                    label="Password"
                    type="password"
                    outlined
                    :disable="!canEdit"
                    hint="Acunetix login password"
                  />
                </div>
              </div>
              
              <div class="q-mt-md">
                <q-btn
                  color="primary"
                  label="Test Connection"
                  @click="testAcunetixConnection"
                  :loading="acunetixTesting"
                  :disable="!canEdit || !settings.toolIntegrations.acunetix.serverAddress || !settings.toolIntegrations.acunetix.email || !settings.toolIntegrations.acunetix.password"
                  class="q-mr-sm"
                />
                <q-chip
                  v-if="acunetixConnectionStatus"
                  :color="acunetixConnectionStatus.success ? 'positive' : 'negative'"
                  text-color="white"
                  :label="acunetixConnectionStatus.message"
                />
              </div>
            </q-card-section>
            
            <q-separator />
            
            <q-card-section>
              <div class="text-bold">Acunetix Export Throttling</div>
              <div class="text-grey-8 q-mb-md">
                Configure throttling settings to prevent rate limiting and improve export reliability for large vulnerability sets.
              </div>
              
              <div class="row q-gutter-md">
                <div class="col-12 col-md-2">
                  <q-input
                    v-model.number="settings.toolIntegrations.acunetix.throttling.chunkSize"
                    label="Chunk Size"
                    type="number"
                    min="50"
                    max="2000"
                    outlined
                    :disable="!canEdit"
                    hint="Vulnerabilities per batch (50-2000)"
                  />
                </div>
                <div class="col-12 col-md-3">
                  <q-input
                    v-model.number="settings.toolIntegrations.acunetix.throttling.throttleDelay"
                    label="Throttle Delay (ms)"
                    type="number"
                    min="0"
                    max="30000"
                    outlined
                    :disable="!canEdit"
                    hint="Delay between batches in milliseconds"
                  />
                </div>
                <div class="col-12 col-md-3">
                  <q-input
                    v-model.number="settings.toolIntegrations.acunetix.throttling.reportCheckInterval"
                    label="Report Check Interval (ms)"
                    type="number"
                    min="1000"
                    max="30000"
                    outlined
                    :disable="!canEdit"
                    hint="How often to check report status"
                  />
                </div>
                <div class="col-12 col-md-3">
                  <q-input
                    v-model.number="settings.toolIntegrations.acunetix.throttling.maxReportWait"
                    label="Max Report Wait (ms)"
                    type="number"
                    min="30000"
                    max="1800000"
                    outlined
                    :disable="!canEdit"
                    hint="Maximum wait time per report"
                  />
                </div>
              </div>
              
              <div class="text-caption text-grey-6 q-mt-sm">
                <strong>Recommended for Cloudflare-protected instances:</strong> Chunk Size: 200, Throttle Delay: 5000ms<br/>
                <strong>Recommended for large instances (1000+ vulns):</strong> Chunk Size: 300, Throttle Delay: 3000ms<br/>
                <strong>High-performance setups:</strong> Chunk Size: 1000, Throttle Delay: 1000ms
              </div>
            </q-card-section>
          </q-card>

        <q-card class="q-my-lg" v-if="canEdit" align="center">
            <q-card-section >
                <q-item>
                    <q-item-section class="q-px-md">
                        <q-btn 
                        :label="$t('saveSettings')"
                        color="secondary"
                        no-caps
                        flat
                        class="bg-secondary text-white"
                        @click="updateSettings"
                        ></q-btn>
                    </q-item-section>
                    <q-item-section class="q-px-md">
                        <q-btn 
                        :label="$t('revertSettingsToDefaults')"
                        color="negative"
                        no-caps
                        flat
                        class="bg-negative text-white"
                        @click="revertToDefaults"
                        ></q-btn>
                    </q-item-section>
                    <q-item-section class="q-px-md">
                        <input
                        ref="importSetttings"
                        value=""
                        type="file"
                        accept=".json"
                        class="hidden"
                        @change="importSettings($event.target.files)"
                        />
                        <q-btn 
                        color="warning"
                        no-caps
                        flat
                        class="bg-warning text-white"
                        @click="$refs.importSetttings.click()"
                        >
                            <div class="row items-center no-wrap">
                                <q-icon left name="fas fa-file-import" class="icon-update-btn"/>
                                <div class="text-center">
                                    {{$t('importSettings')}}
                                </div>
                            </div>
                        </q-btn>
                    </q-item-section>
                    <q-item-section class="q-px-md">
                        <q-btn 
                        color="warning"
                        no-caps
                        flat
                        class="bg-warning text-white"
                        @click="exportSettings"
                        >
                            <div class="row items-center no-wrap">
                                <q-icon left name="fas fa-file-export" class="icon-update-btn"/>
                                <div class="text-center">
                                    {{$t('exportSettings')}}
                                </div>
                            </div>
                        </q-btn>
                    </q-item-section>
                </q-item>
            </q-card-section>
        </q-card>

    </div>
</div>

<q-dialog v-model="pingcastleDialog" persistent>
  <q-card style="min-width: 700px; max-width: 90vw;">
    <q-card-section>
      <div class="text-h6">Edit PingCastle Map</div>
    </q-card-section>
    <q-tabs v-model="pingcastleTab" dense>
      <q-tab name="table" label="Table" />
      <q-tab name="json" label="JSON" />
    </q-tabs>
    <q-separator />
    <q-tab-panels v-model="pingcastleTab" animated>
      <q-tab-panel name="table">
        <div style="max-height: 60vh; overflow-y: auto;">
          <q-table
            :rows="pingcastleMapArray"
            :columns="[
              { name: 'key', label: 'Risk ID', field: 'key', align: 'left', required: true, sortable: true },
              { name: 'value', label: 'Vulnerability Title', field: 'value', align: 'left', required: true, sortable: true },
              { name: 'actions', label: '', field: 'actions', align: 'right' }
            ]"
            row-key="key"
            flat
            hide-bottom
            class="q-mb-md"
            dense
            virtual-scroll
            :rows-per-page-options="[0]"
          >
            <template v-slot:body-cell-key="props">
              <q-td>
                <q-input v-model="props.row.key" dense />
              </q-td>
            </template>
            <template v-slot:body-cell-value="props">
              <q-td>
                <q-input v-model="props.row.value" dense />
              </q-td>
            </template>
            <template v-slot:body-cell-actions="props">
              <q-td>
                <q-btn icon="delete" color="negative" dense flat @click="removePingcastleMapRow(props.rowIndex)" />
              </q-td>
            </template>
          </q-table>
          <q-btn
            color="primary"
            icon="add"
            label="Add Mapping"
            @click="addPingcastleMapRow"
            flat
            dense
            class="q-mt-sm"
          />
        </div>
      </q-tab-panel>
      <q-tab-panel name="json">
        <q-input
          v-model="pingcastleMapJson"
          type="textarea"
          autogrow
          label="PingCastle Map (JSON)"
          :error="pingcastleMapJsonError"
          :error-message="pingcastleMapJsonErrorMsg"
          @input="onPingcastleJsonInput"
          style="min-height: 300px"
        />
      </q-tab-panel>
    </q-tab-panels>
    <q-separator />
    <q-card-actions align="right">
      <q-btn flat label="Cancel" color="primary" v-close-popup />
      <q-btn flat label="Save" color="primary" @click="savePingcastleDialog" :disable="pingcastleMapJsonError" />
    </q-card-actions>
  </q-card>
</q-dialog>

<!-- PurpleKnight Column Exclusions Dialog -->
<q-dialog v-model="purpleknightDialog" persistent>
  <q-card style="width: 600px; max-width: 80vw;">
    <q-card-section>
      <div class="text-h6">Edit PurpleKnight Column Exclusions</div>
      <div class="text-body2 text-grey-7 q-mt-sm">
        These columns will be excluded when parsing PurpleKnight result sheets into HTML tables for the Proof of Concept section.
      </div>
    </q-card-section>
    
    <q-separator />
    
    <q-card-section style="max-height: 400px" class="scroll">
      <div class="q-gutter-sm">
        <div 
          v-for="(exclusion, index) in purpleknightExclusions" 
          :key="index"
          class="row items-center q-gutter-sm"
        >
          <q-input
            v-model="purpleknightExclusions[index]"
            label="Column Name"
            outlined
            dense
            class="col"
          />
          <q-btn 
            icon="delete" 
            color="negative" 
            dense 
            flat 
            @click="removePurpleknightExclusion(index)" 
          />
        </div>
        
        <q-btn
          icon="add"
          label="Add Exclusion"
          color="primary"
          outline
          @click="addPurpleknightExclusion"
          class="q-mt-md"
        />
      </div>
    </q-card-section>
    
    <q-separator />
    
    <q-card-actions align="right">
      <q-btn flat label="Cancel" color="primary" v-close-popup />
      <q-btn flat label="Save" color="primary" @click="savePurpleknightDialog" />
    </q-card-actions>
  </q-card>
</q-dialog>